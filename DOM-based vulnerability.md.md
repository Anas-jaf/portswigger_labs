## 1. What is the DOM?

**DOM (Document Object Model)** is a programming interface for HTML and XML documents. It represents the page so scripts can manipulate the structure, style, and content dynamically. The DOM is a tree-like structure where each element, attribute, and text is a node.

---

## 2. Taint Flow

**Taint flow** refers to tracking how untrusted data (user input or attacker-controlled data) moves through the program, especially from sources (e.g., URL, input fields) to sinks (dangerous functions like `innerHTML`, `eval`). It helps in identifying security risks by marking and tracing "tainted" data.

![[Pasted image 20250802160146.png]]
![[Pasted image 20250802160311.png]]




---

## 3. DOM-based XSS

A form of Cross-Site Scripting where malicious input affects the DOM on the client side, causing script execution. This happens when client-side JavaScript unsafely inserts attacker-controlled data into the page DOM.

![[Pasted image 20250802154323.png]]

![[Pasted image 20250802154754.png]]
---

## 4. Open Redirection

Occurs when a web app takes a URL parameter and redirects users to that URL without validation, allowing attackers to redirect victims to malicious sites.

An **Open Redirect** vulnerability occurs when a web application accepts a user-supplied URL parameter and redirects the user to that URL **without properly validating it**. This allows attackers to craft malicious URLs that appear to come from a trusted site but actually send victims to a harmful external site.


---
### . **كيفية اكتشاف الثغرة**

- **مراجعة العنوان (URL) في المتصفح:**  
    ابحث عن باراميترات في URL تبدو كروابط (مثلاً: `?redirect=`, `?url=`, `?next=`, `?dest=`, `?return=`).
    
- **تجربة تغيير قيمة الباراميتر:**  
    جرّب استبدال قيمة الباراميتر إلى عنوان خارجي مثل:
    
---

### Why is it dangerous?

- **Phishing attacks:** Attackers trick users into clicking a URL from a trusted domain that redirects to a fake login or malware site.
    
- **Bypassing security filters:** Some systems trust URLs from the legitimate site and ignore suspicious domains.
    
- **Session hijacking or malware delivery:** Users redirected to malicious sites may have their credentials stolen or systems infected.

--- 
![[Pasted image 20250802155200.png]]

![[Pasted image 20250802155223.png]]

![[Pasted image 20250802155250.png]]

![[Pasted image 20250802155306.png]]

---
## 5. Cookie Manipulation

An attacker modifies or steals cookies on the client side, potentially changing session data or hijacking sessions, often via JavaScript (`document.cookie`) if not properly secured.

---

## 6. JavaScript Injection

Injection of malicious JavaScript code into the client environment, often through DOM manipulation or unsanitized inputs, leading to script execution.

---

## 7. Document-domain Manipulation

Changing the `document.domain` property to relax same-origin policy restrictions, which can enable unauthorized access between different subdomains, sometimes exploited to bypass security controls.

---

## 8. WebSocket-URL Poisoning

Manipulating the URL used to establish a WebSocket connection to hijack or disrupt communications by injecting malicious parameters or redirecting connections.

---

## 9. Link Manipulation

Altering hyperlinks (`<a href>`) dynamically via JavaScript to mislead users, redirect them to malicious sites, or steal data.

---

## 10. Web Message Manipulation

Exploiting the `postMessage` API to send or intercept messages between windows or iframes, potentially injecting malicious data or intercepting sensitive info.

---

## 11. Ajax Request-Header Manipulation

Tampering with headers of AJAX (XHR or fetch) requests in client-side code to bypass security checks or send malicious payloads.

---

## 12. Local File-Path Manipulation

Manipulating file path parameters in client-side code to access unauthorized local files or directories.

---

## 13. Client-side SQL Injection

Injecting SQL code in client-side logic that interacts with databases (e.g., through local WebSQL or IndexedDB queries) leading to unintended data access or corruption.

---

## 14. HTML5-Storage Manipulation

Abusing client-side storage (LocalStorage, SessionStorage) by injecting or modifying stored data to influence application logic or gain unauthorized access.

---

## 15. Client-side XPath Injection

Injecting malicious XPath queries in client-side XML data processing to manipulate or leak data.

---

## 16. Client-side JSON Injection

Injecting or modifying JSON data parsed or used by client scripts, potentially breaking logic or injecting malicious payloads.

---

## 17. DOM-data Manipulation

Altering DOM elements or data structures in the client to change application behavior, steal data, or cause incorrect operations.

---

## 18. Denial of Service (DoS)

Exploiting client-side code to crash or freeze the browser or web app, often by creating infinite loops, huge memory allocations, or heavy DOM manipulations.

---

## 19. Web Message Vulnerabilities

Issues arising from insecure use of `window.postMessage`, such as accepting messages from untrusted origins leading to data leaks or code execution.

---

## 20. DOM Clobbering

Overwriting native DOM properties or elements by injecting malicious elements or variables with the same names, confusing the JavaScript code and potentially causing XSS or logic errors.

